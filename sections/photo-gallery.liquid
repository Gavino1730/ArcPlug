<style>
.photo-gallery__header { text-align: center; margin-bottom: 1.5rem; }
.photo-gallery__subtitle { margin: 0.5rem auto 0; max-width: 70ch; color: rgba(var(--color-foreground), 0.75); }
.photo-gallery { display: grid; grid-template-columns: repeat(var(--cols-mobile, 2), 1fr); gap: var(--gap, 12px); }
@media screen and (min-width: 750px) { .photo-gallery { grid-template-columns: repeat(var(--cols-desktop, 4), 1fr); } }
.photo-gallery__item { margin: 0; }
.photo-gallery__image { width: 100%; height: 100%; object-fit: cover; display: block; border-radius: var(--media-radius); box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
.photo-gallery__caption { font-size: 1.3rem; color: rgba(var(--color-foreground), 0.7); margin-top: 0.6rem; }
</style>

<section class="photo-gallery-section color-{{ section.settings.color_scheme }} gradient" style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
  <div class="page-width">
    {% if section.settings.title != blank %}
      <header class="photo-gallery__header">
        <h2 class="h2 section-title-divider">{{ section.settings.title }}</h2>
        {% if section.settings.subtitle != blank %}
          <p class="photo-gallery__subtitle">{{ section.settings.subtitle }}</p>
        {% endif %}
      </header>
    {% endif %}

    <div class="photo-gallery"
         style="--cols-desktop: {{ section.settings.columns_desktop }}; --cols-mobile: {{ section.settings.columns_mobile }}; --gap: {{ section.settings.gap }}px;">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'image' %}
            <figure class="photo-gallery__item" {{ block.shopify_attributes }}>
              {% if block.settings.link != blank %}
                <a href="{{ block.settings.link }}" class="photo-gallery__link" {% if block.settings.open_in_new %}target="_blank" rel="noopener"{% endif %}>
              {% endif %}

              {% if block.settings.image != blank %}
                {% liquid
                  assign alt_txt = block.settings.alt | escape
                %}
                {{ block.settings.image
                  | image_url: width: 2000
                  | image_tag: loading: 'lazy', widths: '360, 540, 720, 960, 1200, 1500, 2000', sizes: '(min-width: 990px) 25vw, (min-width: 750px) 33vw, 50vw', alt: alt_txt, class: 'photo-gallery__image' }}
              {% else %}
                {{ 'image' | placeholder_svg_tag: 'placeholder-svg photo-gallery__image' }}
              {% endif %}

              {% if block.settings.link != blank %}</a>{% endif %}

              {% if block.settings.caption != blank %}
                <figcaption class="photo-gallery__caption">{{ block.settings.caption }}</figcaption>
              {% endif %}
            </figure>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Photo Gallery",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Gallery"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Subheading",
      "default": "Shots from Mt. Hood nights to city streets."
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Columns (desktop)"
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2,
      "label": "Columns (mobile)"
    },
    {
      "type": "range",
      "id": "gap",
      "min": 0,
      "max": 32,
      "step": 4,
      "unit": "px",
      "default": 12,
      "label": "Grid gap"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 32
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 32
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "alt", "label": "Alt text", "default": "Gallery image" },
        { "type": "text", "id": "caption", "label": "Caption", "default": "Image caption" },
        { "type": "url", "id": "link", "label": "Optional link" },
        { "type": "checkbox", "id": "open_in_new", "label": "Open link in new tab", "default": false }
      ]
    }
  ],
  "max_blocks": 50,
  "presets": [
    { "name": "Photo Gallery", "blocks": [ { "type": "image" }, { "type": "image" }, { "type": "image" } ] }
  ]
}
{% endschema %}

{# removed dynamic stylesheet block; padding handled inline #}
